# Linux Enumeration

## Cheatsheet [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#cheatsheet)

### Users & Groups [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#users--groups)

|Action|Description|
|---|---|
|`cat /etc/passwd`  <br>  <br>Only usernames:  <br>`cut -d: -f1 /etc/passwd`  <br>  <br>Only username and home directories of users with shells.  <br>`awk -F: '($7 !~ /(false\|nologin)$/) { print $1, $6 }' /etc/passwd`|Lists all user accounts.  <br>  <br>Make sure to check whether there are password hashes in `/etc/passwd`.|
|Lists all groups:  <br>`cat /etc/group`  <br>  <br>Only group with members:  <br>`awk -F: 'NF == 4 && $4 != "" { print }' /etc/group`|Lists all groups and its members.|
|`id`|Displays the name, UID and GID of the current user, alongside its group memberships.|
|`env`|Displays all shell environment variables.|
|`who`  <br>`w`  <br>`finger`|Lists currently logged in users.|
|`lastlog`|Lists when was the last time each user logged in.  <br>  <br>Users who never logged in are less likely targets.|

### Operating System & Architecture [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#operating-system--architecture)

|Action|Description|
|---|---|
|`hostname`|Displays hostname of system.  <br>  <br>This may hint at the purpose of the host.|
|Linux distro:  <br>`cat /etc/issue`  <br>`cat /etc/*-release`  <br>  <br>Kernel version .  <br>`(cat /proc/version \| uname -a ) 2>/dev/null`|Displays the Linux distribution and kernel version.|
|`arch`|Displays the CPU architecture.|
|`realm list`|Check if Linux host is Active Directory domain-joined.  <br>  <br>If it is, this command will output a bunch of information. Pay attention to the fields:  <br>- `domain-name`  <br>- `permitted-logins`  <br>- `permitted-groups`  <br>- `configured` (if it’s `kerberos-member`, PtH is possible)|
|`ps -ef \| grep -i "winbind\|sssd"`|If the realms command does not exist, try to footprint by searching for AD tools such as `winbind` and `sssd`.|

### Network [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#network)

|Action|Description|
|---|---|
|`ip a`|Displays all network interface configurations, including IP addresses and subnet masks.|
|`ss -tunap \| awk 'NR==1 \| /ESTAB\|LISTEN/'`|Displays active network connections and their associated PID.  <br>  <br>`ESTAB`: Actively connected and exchanging data.  <br>`LISTEN`: Waiting for someone to connect.|
|Gateway:  <br>`ip route`  <br>  <br>DNS:  <br>`cat /etc/resolv.conf`|Enumerates the default gateway and DNS server.|
|`cat /etc/hosts`|Displays the local host-to-IP address mappings on the system.|
|`arp -a`|Displays the system’s ARP cache.  <br>  <br>Useful for identifying nearby or potentially new hosts.|

### File System [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#file-system)

|Action|Description|
|---|---|
|`ls -la /opt /var/backups /var/opt /var/mail /tmp /var/tmp`|Check the contents of directories that often contains interesting files.|
|`find / -writable -type d 2>/dev/null`|Finds writable directories by the current user.|
|`find /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -type f -exec getcap {} \;`|Finds files with capabilities set in common system binary directories.|

### Programs [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#programs)

|Action|Description|
|---|---|
|`which nmap aws nc ncat netcat nc.traditional wget curl ping gcc g++ make gdb base64 socat python python2 python3 python2.7 python2.6 python3.6 python3.7 perl php ruby xterm doas sudo fetch docker lxc ctr runc rkt kubectl 2>/dev/null`|Checks whether a bunch of useful programs are present on the system.|

TODO

### Processes & Services [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#processes--services)

|Action|Description|
|---|---|
|`./nmap -T4 -v 127.0.0.1`|Using a static binary of Nmap (LINK), runs an internal scan for services.|
|`ps aux`  <br>  <br>Filter processes by a particular user:  <br>`ps aux \| grep <user>`|Lists system processes.  <br>  <br>TODO what about pspy64|

### Security [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-enumeration/#security)

|Action|Description|
|---|---|
|If the Debian `iptables-persistent` package as used:  <br>`cat /etc/iptables/rules.v4`|By default, we usually need `root` access to see the Firewall setting for a system.  <br>  <br>However, under some circumstances, we may be able to enumerate them as a low-privileged user.|