# Windows Enumeration

## Cheatsheet [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#cheatsheet)

### Users & Groups [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#users--groups)

|Action|Description|
|---|---|
|CMD:  <br>`net user`  <br>`net user <user>`  <br>  <br>Powershell:  <br>`Get-LocalUser`  <br>`Get-LocalUser -Name <user>`|Lists all local user accounts.  <br>  <br>Inspect properties of specific interesting users.  <br>Useful to verify if the built-in Administrator is enabled.|
|CMD:  <br>`net localgroup`  <br>`net localgroup "<group-name>`"  <br>  <br>Powershell:  <br>`Get-LocalGroup`  <br>`Get-LocalGroupMember "<group-name>"`|Lists all local groups and its members.  <br>  <br>Inspect members of a specific interesting groups, such as:  <br>- `Adminitrators`  <br>- `Remote Desktop Users`  <br>- `Remote Management Users`  <br>etc.|
|`whoami /priv`|Displays the privileges of the current user.|
|`whoami /groups`|Lists the groups the current user belongs to.|
|`net accounts`|Displays password policy.|
|`set`|Displays all shell environment variables.|

### Operating System & Architecture [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#operating-system--architecture)

|Action|Description|
|---|---|
|`systeminfo`|Retrieves detailed system information.  <br>  <br>Pay special attention to:  <br>- OS version  <br>- Build number (compare it [here](https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions))  <br>- System architecture (see `System Type`)  <br>- The AD domain, if applicable  <br>- The Domain Controller, if applicable (`LoggonServer`)|
|`Get-WmiObject -Class Win32_OperatingSystem \| select Description`|Gets the description field of the host.|

### Network [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#network)

|Action|Description|
|---|---|
|`ipconfig /all`|Displays all network interface configurations, including IP addresses, subnet masks, gateways, and DNS servers.|
|`route print`|Displays the IPv4 and IPv6 routing table, showing known networks and Layer 3 routes.  <br>  <br>Routes listed here may indicate reachable subnets, making them potential targets for lateral movement.|
|`netstat -ano`|Displays active network connections and their associated PID.  <br>  <br>`ESTABLISHED`: Actively connected and exchanging data.  <br>`LISTENING`: Waiting for someone to connect.|

### Processes & Programs [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#processes--programs)

|Action|Description|
|---|---|
|`$INSTALLED = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* \| Select-Object DisplayName, DisplayVersion, InstallLocation`  <br>  <br>`$INSTALLED += Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* \| Select-Object DisplayName, DisplayVersion, InstallLocation`  <br>  <br>`$INSTALLED \| ?{ $_.DisplayName -ne $null } \| sort-object -Property DisplayName -Unique \| Format-Table -AutoSize`|Queries both 32-bit and 64-bit registry keys for installed applications and their versions.  <br>  <br>Be sure to look for CVEs.|
|`dir "C:\Program Files"`  <br>`dir "C:\Program Files (x86)"`|Lists applications in the Program Files directories.  <br>  <br>Useful for spotting tools or software not recorded in the uninstall keys.|
|`Get-Process`  <br>  <br>Only unique names:  <br>`Get-Process \| Select-Object -ExpandProperty ProcessName \| Sort-Object -Unique`|Enumerates running processes.  <br>  <br>Focus on interesting or uncommon names.|

### Security [](https://field-manual.brunorochamoura.com/manual/post-exploitation/windows-post-exploitation/windows-enumeration/#security)

|Action|Description|
|---|---|
|`Get-MpComputerStatus`|Checks Windows Defender status.|
|`Get-CimInstance -Class win32_quickfixengineering \| Where-Object { $_.Description -eq "Security Update" }`|Enumerates installed security updates.|
|Check if UAC is enabled.  <br>If it’s 0x1, it’s enabled. If it’s 0x0, it’s disabled.  <br>`REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA`  <br>  <br>Check UAC level.  <br>`REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin`|Confirms if UAC is enabled and, if so, at what level.|
|`netsh firewall show state`  <br>`netsh firewall show config`|Displays firewall state and configuration.|
  

Use [WinPEAS](https://github.com/peass-ng/PEASS-ng/releases) to automate the enumeration process if in a hurry.